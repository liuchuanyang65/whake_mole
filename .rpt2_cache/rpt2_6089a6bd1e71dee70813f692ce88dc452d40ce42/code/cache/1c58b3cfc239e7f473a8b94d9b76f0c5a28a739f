{
  "code": "import { gameData } from \"./gameData\";\r\nimport { WXCloud } from \"./WXCloud\";\r\nexport class Share {\r\n    constructor() {\r\n        this.isChallenge = false;\r\n        this.challengeId = \"\";\r\n        Share._instance = this;\r\n        if (Laya.Browser.onMiniGame) {\r\n            Share.wx = Laya.Browser.window.wx;\r\n            this.InitShare();\r\n            this.onShow();\r\n        }\r\n    }\r\n    InitShare() {\r\n        if (Laya.Browser.onWeiXin) {\r\n            console.log(\"初始化分享设置～\");\r\n            Share.wx.showShareMenu({\r\n                withShareTicket: true,\r\n                success: function (res) {\r\n                    console.log(\"开启转发成功～\");\r\n                },\r\n                fail: function (res) {\r\n                    console.log(\"开启转发失败～\");\r\n                },\r\n                complete: function (res) {\r\n                }\r\n            });\r\n            Share.wx.onShareAppMessage(function () {\r\n                return {\r\n                    title: '打地鼠可好玩了,快来挑战我吧～',\r\n                };\r\n            });\r\n        }\r\n    }\r\n    doShare(nickName) {\r\n        var str = `${nickName}向你发起挑战！`;\r\n        console.log(str);\r\n        if (Laya.Browser.onWeiXin) {\r\n            const shareInfo = {\r\n                title: str,\r\n                query: `action=challenge&userId=${gameData.player.id}`\r\n            };\r\n            Share.wx.shareAppMessage(shareInfo);\r\n        }\r\n    }\r\n    onShow() {\r\n        if (Laya.Browser.onWeiXin) {\r\n            Share.wx.onShow(res => {\r\n                let m_shareTicket = res.shareTicket;\r\n                let query = res.query;\r\n                if (query != null) {\r\n                    if (query.action == \"challenge\") {\r\n                        console.log(query.userId);\r\n                        this.challengeId = query.userId;\r\n                        if (WXCloud._instance.mgr != null) {\r\n                            WXCloud._instance.UpdateChallengeData(this.challengeId);\r\n                        }\r\n                        else {\r\n                            this.isChallenge = true;\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n}\r\n",
  "references": [
    "C:/Users/dell/Desktop/my_mouse/src/script/gameData.ts",
    "C:/Users/dell/Desktop/my_mouse/src/script/WXCloud.ts"
  ]
}
